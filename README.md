# FastAPI для BERT-модели бинарной классификации

Это проект на базе FastAPI для работы с дообученной моделью BERT, которая является бинарным классификатором. Модель предназначена для определения, является ли промпт **jailbreak** (незаконным или несанкционированным запросом) или нет. Проект предоставляет API для проверки промптов и позволяет использовать Swagger для тестирования.

## Описание проекта

Этот проект включает в себя FastAPI приложение с API, которое принимает текстовые промпты и классифицирует их с использованием дообученной модели BERT. Модель BERT обучена на задаче бинарной классификации и принимает решение, является ли переданный промпт **jailbreak** или нет.

Основные особенности:
- Используется модель BERT, дообученная для классификации промптов.
- FastAPI для построения API и интеграции с моделью.
- Swagger UI для тестирования API и отправки запросов.

### Файлы проекта

- **main.py**: Основной файл, который запускает FastAPI сервер. Он содержит API-методы, включая эндпоинт для проверки промптов.
  
- **prompt_defender.py**: В этом файле реализован класс `PromptDefenderClassifier`, который загружает модель и токенизатор, а также содержит метод для предсказания, является ли промпт jailbreak.

- **my_bert_model/**: Папка с весами модели и необходимыми файлами для работы модели BERT.

- **requirements.txt**: Список зависимостей, необходимых для запуска проекта.

## Инструкция по использованию

### 1. Необходимые файлы
Для работы с моделью вам нужно скачать файл с весами дообученной модели BERT.

В папке my_bert_model должны быть следующие файлы:

- **config.json**
- **model.safetensors**
- **special_tokens_map.json**
- **tokenizer_config.json**
- **vocab.txt**

### 2. Установите зависимости

Для начала убедитесь, что у вас установлены все необходимые зависимости. Выполните следующую команду, чтобы установить зависимости из файла `requirements.txt`:

```bash
pip install -r requirements.txt
```

### 2. Запуск API

Для запуска сервера выполните следующую команду:

```bash
uvicorn main:app --reload
```
Документация
Документация API автоматически генерируется и доступна по адресу:

Swagger UI: http://127.0.0.1:8000/docs

